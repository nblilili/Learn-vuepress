(window.webpackJsonp=window.webpackJsonp||[]).push([[478],{910:function(a,s,t){"use strict";t.r(s);var n=t(29),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"屏幕共享集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#屏幕共享集成"}},[a._v("#")]),a._v(" 屏幕共享集成")]),a._v(" "),t("p",[a._v("集成屏幕共享功能前，请确保您已经集成了多方音视频通话。")]),a._v(" "),t("p",[a._v("屏幕共享可以让您和频道中的其他成员一起分享设备里的精彩内容，您可以在频道中利用屏幕共享的功能进行文档演示、在线教育演示、视频会议以及游戏过程分享等。")]),a._v(" "),t("h2",{attrs:{id:"设置要共享的桌面或窗口id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置要共享的桌面或窗口id"}},[a._v("#")]),a._v(" 设置要共享的桌面或窗口id")]),a._v(" "),t("p",[a._v("开启桌面或窗口共享前，需要调用下面的接口获取桌面列表或者窗口列表。")]),a._v(" "),t("p",[a._v("获取窗口列表")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 桌面列表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" List"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("JCMediaDeviceWindow"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" desktops\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 窗口列表")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" List"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("JCMediaDeviceWindow"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" windows\n")])])]),t("p",[a._v("其中，JCMediaDeviceWindow 类有以下两个属性")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 名称")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")]),a._v(" windowName\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// id")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")]),a._v(" windowId\n")])])]),t("p",[a._v("示例代码")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("JCMediaDeviceWindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" desktops "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" mediaDevice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("desktops"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("JCMediaDeviceWindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" windows "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" mediaDevice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("windows"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("桌面列表或者窗口列表获取后，通过 JCMediaDevice 类的 screenshareWindow 属性设置要共享的窗口或桌面id")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 屏幕分享的窗口")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// </summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" JCMediaDeviceWindow screenshareWindow\n")])])]),t("p",[a._v("示例代码")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[a._v("mediaDevice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenshareWindow "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" desktops"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")])]),a._v(" windowId "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" mediaDevice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenshareWindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("windowId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h2",{attrs:{id:"屏幕共享采集属性设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#屏幕共享采集属性设置"}},[a._v("#")]),a._v(" 屏幕共享采集属性设置")]),a._v(" "),t("p",[a._v("您可以调用 JCMediaDevice 类中的 setScreenCaptureProperty 方法设置屏幕共享采集属性，包括采集的高度、宽度和帧速率。")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 设置屏幕桌面共享采集属性")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// </summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="width">采集宽度</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="height">采集高度</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="framerate">帧速率</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("setScreenCaptureProperty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")])]),a._v(" width"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")])]),a._v(" height"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")])]),a._v(" framerate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("该方法可以在开启屏幕共享前调用，也可以在屏幕共享中调用；如果在屏幕共享中调用，则设置的采集属性要在下次屏幕共享开启时生效。")])]),a._v(" "),t("h2",{attrs:{id:"开启或关闭屏幕共享"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开启或关闭屏幕共享"}},[a._v("#")]),a._v(" 开启或关闭屏幕共享")]),a._v(" "),t("p",[a._v("开启或关闭屏幕共享需要根据当前的屏幕共享状态进行判断，具体通过 screenUserId 进行判断。当 screenUserId 不为空时说明当前存在屏幕共享，不能再发起屏幕共享，只有当 screenUserId 为空时才可以发起屏幕共享。")]),a._v(" "),t("p",[a._v("屏幕共享状态是否变化通过 screenShare 判断。如果屏幕共享状态发生了改变会触发 onMediaChannelPropertyChange 回调")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 属性变化回调，目前主要关注屏幕共享和窗口共享状态的更新")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// </summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="propChangeParam">变化集合</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("onMediaChannelPropertyChange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JCMediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("PropChangeParam")]),a._v(" propChangeParam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("如果当前不存在屏幕共享或者自己发起了屏幕共享，可以调用下面的方法开启或关闭屏幕共享")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 开启关闭桌面屏幕共享，内部根据当前状态决定是否开启")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// </summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="enable">是否开启屏幕共享</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <returns>返回true表示调用成功，false表示调用失败</returns>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bool")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("enableScreenOrWindowShare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bool")])]),a._v(" enable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h2",{attrs:{id:"请求屏幕共享的视频流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#请求屏幕共享的视频流"}},[a._v("#")]),a._v(" 请求屏幕共享的视频流")]),a._v(" "),t("p",[a._v("如果频道中有成员开启了屏幕共享，其他成员将收到 onMediaChannelPropertyChange 的回调，并通过 screenUserId 属性获得发起屏幕共享的用户标识。")]),a._v(" "),t("p",[a._v("获得发起屏幕共享的用户标识后，可以调用 requestScreenVideo 方法请求屏幕共享的视频流")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 请求屏幕共享的视频流")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// 当pictureSize未None表示关闭请求")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// </summary>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="screenUri">屏幕分享uri</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/// <param name="pictureSize">视频请求尺寸类型</param>')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/// <returns>返回true表示调用成功，false表示调用失败</returns>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bool")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("requestScreenVideo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("string")])]),a._v(" screenUri"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JCMediaChannelPictureSize")]),a._v(" pictureSize"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("p",[a._v("示例代码")]),a._v(" "),t("div",{staticClass:"language-csharp extra-class"},[t("pre",{pre:!0,attrs:{class:"language-csharp"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("onMediaChannelPropertyChange")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JCMediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("PropChangeParam")]),a._v(" propChangeParam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("propChangeParam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenShare"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenUserId "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 开启屏幕共享")]),a._v("\n            mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("enableScreenOrWindowShare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 请求屏幕共享的视频流")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JCMediaDeviceVideoCanvas")]),a._v(" screenShare "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" mediaDevice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("startVideo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenRenderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" JCMediaDeviceRenderMode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("FULLCONTENT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("requestScreenVideo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenRenderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("JCMediaChannelPictureSize"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Large"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("screenUserId "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"自己开启了屏幕共享"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 关闭屏幕共享")]),a._v("\n            mediaChannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("enableScreenOrWindowShare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);