(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{344:function(e,n,t){e.exports=t.p+"assets/img/1-1workflowWindows.d9fa59f0.png"},498:function(e,n,t){"use strict";t.r(n);var a=t(43),r=Object(a.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"实现一对一语音通话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现一对一语音通话"}},[e._v("#")]),e._v(" 实现一对一语音通话")]),e._v(" "),a("p",[e._v("本章将介绍如何实现一对一语音通话，一对一语音通话的 API 调用时序见下图：")]),e._v(" "),a("p",[a("img",{attrs:{src:t(344),alt:"../../../../_images/1-1workflowWindows.png"}})]),e._v(" "),a("h2",{attrs:{id:"初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[e._v("#")]),e._v(" 初始化")]),e._v(" "),a("p",[e._v("调用\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/cb59bc27-6528-9dbf-c996-de857096f847.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("JCMediaDevice.create()"),a("OutboundLink")],1),e._v("\n和\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/eef10110-a3f7-b505-26fa-4b9ec1e2b998.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("JCCall.create()"),a("OutboundLink")],1),e._v("\n以初始化实现一对一通话需要的模块：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("/// 新建类并实现\nclass JCManager : JCClientCallback, JCMediaDeviceCallback,JCCallCallbac{\n\n    #region JCMediaDeviceCallback\n\n    public void onCameraUpdate(){...}\n\n    public void onAudioOutputTypeChange(string audioOutputType){...}\n\n    #endregion\n\n    #region JCCallCallbac\n    ...\n    /// 实现 JCCallCallbac 中的方法\n    ...\n    #endregion\n\n    /// 声明对象\n    JCMediaDevice mMediaDevice;\n    JCMediaChannel mMediaChannel;\n\n    /// 初始化函数\n    public bool initialize(Context context) {\n\n        /// 1. 媒体类\n        mMediaDevice = JCMediaDevice.create(mClient, this);\n        /// 2. 通话类\n        mCall = JCCall.create(mClient, mMediaDevice, this);\n    }\n}\n")])])]),a("h2",{attrs:{id:"拨打通话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拨打通话"}},[e._v("#")]),e._v(" 拨打通话")]),e._v(" "),a("p",[e._v("调用\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/613adf03-d597-8221-86d5-0056c1b4d2a0.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("call()"),a("OutboundLink")],1),e._v("\n发起语音通话，需要填写的参数有：")]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("userID")]),e._v(" 填写对方的用户ID。")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("video")]),e._v(" 选择是否为视频通话， true 表示拨打视频通话， false 表示拨打语音通话。")])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/e0226cbc-1ca1-ef9c-5e8e-d3dc853d618d.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("extraParam()"),a("OutboundLink")],1),e._v("\n为自定义透传字符串， 可通过 "),a("code",[e._v("item.extraParam")]),e._v(" 获取该属性。")]),e._v(" "),a("p",[e._v("/// 发起语音呼叫\nmCall.call(userID, isVideo, extraParam);")])])]),e._v(" "),a("p",[e._v("拨打通话后，主叫和被叫均会收到新增通话的回调\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/5e605b62-c8dc-4dde-2480-8fdcbbfc2f48.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("onCallItemAdd()"),a("OutboundLink")],1),e._v("\n，此时通话状态变为\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/2134e734-614d-4a19-f411-5fe1a81d3ccd.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("STATE_PENDING"),a("OutboundLink")],1),e._v("\n。您可以通过重写\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/5e605b62-c8dc-4dde-2480-8fdcbbfc2f48.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("onCallItemAdd()"),a("OutboundLink")],1),e._v("\n执行逻辑操作。")]),e._v(" "),a("p",[e._v("示例代码:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("/// 1. 发起语音通话\nmCall.call(userID, false, null);\n\n/// 2. 重写回调\n\npublic void onCallItemAdd(JCCallItem item) {\n    /// 业务逻辑\n    if (item.direction == JCCall.DIRECTION_IN) {\n        /// 如果是被叫\n        ...\n    }else{\n        /// 如果是主叫\n        ...\n    }\n}\n")])])]),a("h2",{attrs:{id:"应答通话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应答通话"}},[e._v("#")]),e._v(" 应答通话")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("被叫收到\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/5e605b62-c8dc-4dde-2480-8fdcbbfc2f48.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("onCallItemAdd()"),a("OutboundLink")],1),e._v("\n回调，在回调中根据\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/0267696e-79ee-8d46-c086-3c071a2b2b3a.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("JCCallItem"),a("OutboundLink")],1),e._v("\n属性来判断是视频呼入还是语音呼入，从而做出相应的处理。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("public void onCallItemAdd(JCCallItem item) {\n    /// 1. 如果是语音呼入且在振铃中\n    if (item.direction == JCCall.DIRECTION_IN && !item.video) {\n        /// 2. 做出相应的处理，如在界面上显示“振铃中”\n        ...\n    }\n}\n")])])])]),e._v(" "),a("li",[a("p",[e._v("调用\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/7211e914-c311-4457-4b0e-bc4ef46c7733.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("answer()"),a("OutboundLink")],1),e._v("\n接听通话。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("mCall.answer(item, false);\n")])])])])]),e._v(" "),a("p",[e._v("通话接听后，通话状态变为 STATE_CONNECTING。")]),e._v(" "),a("p",[e._v("Note")]),e._v(" "),a("p",[e._v("如果要在此时拒绝通话，请调用挂断通话的接口。这种情况下调用挂断后，通话状态变为 STATE_CANCELED。")]),e._v(" "),a("h2",{attrs:{id:"挂断通话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#挂断通话"}},[e._v("#")]),e._v(" 挂断通话")]),e._v(" "),a("p",[e._v("主叫或者被叫均可以挂断通话。")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("调用\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/6df31ff9-272f-c7cc-1da6-2755c5aad5e0.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("getActiveCallItem()"),a("OutboundLink")],1),e._v("\n获取当前活跃的通话对象:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("mCall.getActiveCallItem();\n")])])])]),e._v(" "),a("li",[a("p",[e._v("调用\n"),a("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/windows/html/70758778-1450-172d-8684-3dd2818f2a84.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("term()"),a("OutboundLink")],1),e._v("\n挂断当前活跃通话:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("mCall.term(item, reason, description);\n")])])])])]),e._v(" "),a("p",[e._v("示例代码:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("/// 1. 获取当前活跃通话\nJCCallItem item = mCall.getActiveCallItem();\n/// 2. 挂断当前活跃通话\nmCall.term(item, JCCall.REASON_NONE, null);\n")])])])])}),[],!1,null,null,null);n.default=r.exports}}]);