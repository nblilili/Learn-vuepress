(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{343:function(e,n,a){e.exports=a.p+"assets/img/1-1workflowandroid.d9fa59f0.png"},497:function(e,n,a){"use strict";a.r(n);var l=a(43),o=Object(l.a)({},(function(){var e=this,n=e.$createElement,l=e._self._c||n;return l("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[l("h1",{attrs:{id:"实现一对一语音通话"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#实现一对一语音通话"}},[e._v("#")]),e._v(" 实现一对一语音通话")]),e._v(" "),l("p",[e._v("本章将介绍如何实现一对一语音通话，一对一语音通话的 API 调用时序见下图：")]),e._v(" "),l("p",[l("img",{attrs:{src:a(343),alt:"../../../../_images/1-1workflowandroid.png"}})]),e._v(" "),l("h2",{attrs:{id:"初始化"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[e._v("#")]),e._v(" 初始化")]),e._v(" "),l("p",[e._v("调用\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCMediaDevice.html#create-com.juphoon.cloud.JCClient-com.juphoon.cloud.JCMediaDeviceCallback-",target:"_blank",rel:"noopener noreferrer"}},[e._v("JCMediaDevice.create()"),l("OutboundLink")],1),e._v("\n和\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#create-com.juphoon.cloud.JCClient-com.juphoon.cloud.JCMediaDevice-com.juphoon.cloud.JCCallCallback-",target:"_blank",rel:"noopener noreferrer"}},[e._v("JCCall.create()"),l("OutboundLink")],1),e._v("\n以初始化实现一对一通话需要的模块：")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("// 声明对象\nJCMediaDevice mMediaDevice;\nJCCall mCall;\n\n// 初始化函数\npublic boolean initialize(Context context) {\n    //1. 媒体类\n    mMediaDevice = JCMediaDevice.create(mClient, new JCMediaDeviceCallback() {\n        @Override\n        public void onCameraUpdate() {\n\n        }\n        @Override\n        public void onAudioOutputTypeChange(int i) {\n\n        }\n        @Override\n        public void onRenderReceived(JCMediaDeviceVideoCanvas jcMediaDeviceVideoCanvas) {\n\n        }\n        @Override\n        public void onRenderStart(JCMediaDeviceVideoCanvas jcMediaDeviceVideoCanvas) {\n\n        }\n    });\n    //2. 通话类\n    mCall = JCCall.create(mClient, mMediaDevice, new JCCallCallback() {\n        @Override\n        public void onCallItemAdd(JCCallItem jcCallItem) {\n\n        }\n\n        @Override\n        public void onCallItemRemove(JCCallItem jcCallItem, int i, String s) {\n\n        }\n\n        @Override\n        public void onCallItemUpdate(JCCallItem jcCallItem, JCCallItem.ChangeParam changeParam) {\n\n        }\n\n        @Override\n        public void onMessageReceive(String s, String s1, JCCallItem jcCallItem) {\n\n        }\n\n        @Override\n        public void onMissedCallItem(JCCallItem jcCallItem) {\n\n        }\n    });\n}\n")])])]),l("h2",{attrs:{id:"拨打通话"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#拨打通话"}},[e._v("#")]),e._v(" 拨打通话")]),e._v(" "),l("p",[e._v("调用\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#call-java.lang.String-boolean-java.lang.String-",target:"_blank",rel:"noopener noreferrer"}},[e._v("call()"),l("OutboundLink")],1),e._v("\n发起语音通话，需要填写的参数有：")]),e._v(" "),l("ul",[l("li",[l("p",[l("code",[e._v("userID")]),e._v(" 填写对方的用户ID。")])]),e._v(" "),l("li",[l("p",[l("code",[e._v("video")]),e._v(" 选择是否为视频通话， true 表示拨打视频通话， false 表示拨打语音通话。")])]),e._v(" "),l("li",[l("p",[l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#call-java.lang.String-boolean-java.lang.String-",target:"_blank",rel:"noopener noreferrer"}},[e._v("extraParam()"),l("OutboundLink")],1),e._v("\n为自定义透传字符串， 可通过\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCallItem.html#getExtraParam--",target:"_blank",rel:"noopener noreferrer"}},[e._v("getExtraParam()"),l("OutboundLink")],1),e._v("\n方法获取该属性。")]),e._v(" "),l("p",[e._v("// 发起语音呼叫\nmCall.call(userID, isVideo, extraParam);")])])]),e._v(" "),l("p",[e._v("拨打通话后，主叫和被叫均会收到新增通话的回调\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCallCallback.html#onCallItemAdd-com.juphoon.cloud.JCCallItem-",target:"_blank",rel:"noopener noreferrer"}},[e._v("onCallItemAdd()"),l("OutboundLink")],1),e._v("\n，此时通话状态变为\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#STATE_PENDING",target:"_blank",rel:"noopener noreferrer"}},[e._v("STATE_PENDING"),l("OutboundLink")],1),e._v("\n。您可以通过重写\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCallCallback.html#onCallItemAdd-com.juphoon.cloud.JCCallItem-",target:"_blank",rel:"noopener noreferrer"}},[e._v("onCallItemAdd()"),l("OutboundLink")],1),e._v("\n执行逻辑操作。")]),e._v(" "),l("p",[e._v("示例代码:")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("// 1. 发起语音通话\nmCall.call(userID, false, null);\n\n// 2. 重写回调\n@Override\npublic void onCallItemAdd(JCCallItem item) {\n    // 业务逻辑\n    if (item.direction == JCCall.DIRECTION_IN) {\n        // 如果是被叫\n        ...\n    }else{\n        // 如果是主叫\n        ...\n    }\n}\n")])])]),l("h2",{attrs:{id:"应答通话"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#应答通话"}},[e._v("#")]),e._v(" 应答通话")]),e._v(" "),l("ol",[l("li",[l("p",[e._v("被叫收到\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCallCallback.html#onCallItemAdd-com.juphoon.cloud.JCCallItem-",target:"_blank",rel:"noopener noreferrer"}},[e._v("onCallItemAdd()"),l("OutboundLink")],1),e._v("\n回调，在回调中调用\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCallItem.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("JCCallItem"),l("OutboundLink")],1),e._v("\n中的\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCallItem.html#getVideo--",target:"_blank",rel:"noopener noreferrer"}},[e._v("getVideo()"),l("OutboundLink")],1),e._v("\n方法获取 "),l("code",[e._v("video")]),e._v(" 属性来判断是视频呼入还是语音呼入，从而做出相应的处理。")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("@Override\npublic void onCallItemAdd(JCCallItem item) {\n    // 1. 如果是语音呼入且在振铃中\n    if (item.getDirection() == JCCall.DIRECTION_IN && !item.getVideo()) {\n        // 2. 做出相应的处理，如在界面上显示“振铃中”\n        ...\n    }\n}\n")])])])]),e._v(" "),l("li",[l("p",[e._v("调用\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#answer-java.lang.String-boolean-java.lang.String-",target:"_blank",rel:"noopener noreferrer"}},[e._v("answer()"),l("OutboundLink")],1),e._v("\n接听通话。")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("mCall.answer(item, false);\n")])])])])]),e._v(" "),l("p",[e._v("通话接听后，通话状态变为 STATE_CONNECTING。")]),e._v(" "),l("p",[e._v("Note")]),e._v(" "),l("p",[e._v("如果要在此时拒绝通话，请调用挂断通话的接口。这种情况下调用挂断后，通话状态变为 STATE_CANCELED。")]),e._v(" "),l("h2",{attrs:{id:"挂断通话"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#挂断通话"}},[e._v("#")]),e._v(" 挂断通话")]),e._v(" "),l("p",[e._v("主叫或者被叫均可以挂断通话。")]),e._v(" "),l("ol",[l("li",[l("p",[e._v("调用\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#getActiveCallItem--",target:"_blank",rel:"noopener noreferrer"}},[e._v("getActiveCallItem()"),l("OutboundLink")],1),e._v("\n获取当前活跃的通话对象:")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("mCall.getActiveCallItem();\n")])])])]),e._v(" "),l("li",[l("p",[e._v("调用\n"),l("a",{attrs:{href:"https://developer.juphoon.com/portal/reference/V2.1/android/com/juphoon/cloud/JCCall.html#term-com.juphoon.cloud.JCCallItem-int-java.lang.String-",target:"_blank",rel:"noopener noreferrer"}},[e._v("term()"),l("OutboundLink")],1),e._v("\n挂断当前活跃通话:")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("mCall.term(item, reason, description);\n")])])])])]),e._v(" "),l("p",[e._v("示例代码:")]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",[l("code",[e._v("// 1. 获取当前活跃通话\nJCCallItem item = mCall.getActiveCallItem();\n// 2. 挂断当前活跃通话\nmCall.term(item, JCCall.REASON_NONE, null);\n")])])])])}),[],!1,null,null,null);n.default=o.exports}}]);